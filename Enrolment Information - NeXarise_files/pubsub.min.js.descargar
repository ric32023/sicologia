define(function(){var n={create:function(n){"use strict";var r;if(typeof n.pubsubEnabled!="undefined")return n;var i=n||{},t={},u=-1;return i.pubsubEnabled=!0,r=function(n,i){if(!t.hasOwnProperty(n))return!1;var r=function(){for(var u=t[n],f=function(n){return function(){throw n;}},r=0,e=u.length;r<e;r++)try{u[r].func(i)}catch(o){setTimeout(f(o),0)}};return setTimeout(r,0),!0},i.trigger=function(n,t){return r(n,t,!1)},i.on=function(n,i,r){var e,o,f,s;if(t.hasOwnProperty(n)||(t[n]=[]),e=r,o=typeof i!="function",o||(e=i,i=(++u).toString()),o)for(f=0,s=t[n].length;f<s;f++)t[n][f].token==i&&t[n].splice(f,1);return t[n].push({token:i,func:e}),i},i.off=function(n){var i,r,u;for(i in t)if(t.hasOwnProperty(i))for(r=0,u=t[i].length;r<u;r++)if(t[i][r].token===n)return t[i].splice(r,1),n;return!1},i}};return n.create(window),n});